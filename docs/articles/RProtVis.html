<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visualisation of proteomics data using R and Bioconductor â€¢ RforProteomics</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Visualisation of proteomics data using R and Bioconductor">
<meta property="og:description" content="RforProteomics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RforProteomics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.27.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/RforProteomics.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/RProtVis.html">Visualisation of proteomics data using R and Bioconductor</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="RProtVis_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="RProtVis_files/jquery-1.12.4/jquery.min.js"></script><link href="RProtVis_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="RProtVis_files/datatables-binding-0.13/datatables.js"></script><link href="RProtVis_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="RProtVis_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="RProtVis_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="RProtVis_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="RProtVis_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Visualisation of proteomics data using R and Bioconductor</h1>
                        <h4 class="author">Laurent Gatto</h4>
                                    <h4 class="author">Lisa Breckels</h4>
                                    <h4 class="author">Sebastian Gibb</h4>
                        
      
      
      <div class="hidden name"><code>RProtVis.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>This is the companion vignette to the 'Using R and Bioconductor for proteomics data analysis' manuscript that presents an overview of R and Bioconductor software for mass spectrometry and proteomics data. It provides the code to reproduce the figures in the paper.</p>
    </div>
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette illustrates existing  and Bioconductor infrastructure for the visualisation of mass spectrometry and proteomics data. The code details the visualisations presented in</p>
<blockquote>
<p>Gatto L, Breckels LM, Naake T, Gibb S. Visualisation of proteomics data using R and Bioconductor. Proteomics. 2015 Feb 18. doi: 10.1002/pmic.201400392. PubMed PMID: <a href="http://www.ncbi.nlm.nih.gov/pubmed/25690415">25690415</a>.</p>
</blockquote>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ul>
<li>CRAN Task View: Graphic Displays &amp; Dynamic Graphics &amp; Graphic Devices &amp; Visualization: <a href="http://cran.r-project.org/web/views/Graphics.html" class="uri">http://cran.r-project.org/web/views/Graphics.html</a>
</li>
<li>CRAN Task View: Web Technologies and Services: <a href="http://cran.r-project.org/web/views/WebTechnologies.html" class="uri">http://cran.r-project.org/web/views/WebTechnologies.html</a>
</li>
<li>ggplot2 <a href="http://link.springer.com/book/10.1007%2F978-0-387-98141-3">book</a> (syntax is slightly outdated) (<a href="http://ggplot2.org/book/">code</a>), <a href="http://ggplot2.org/">web page</a> and <a href="http://docs.ggplot2.org/current/">on-line docs</a>
</li>
<li>lattice <a href="http://lmdvr.r-forge.r-project.org/figures/figures.html">book</a> and <a href="http://lattice.r-forge.r-project.org/">web page</a>
</li>
<li>
<em>R Graphics</em> <a href="https://www.stat.auckland.ac.nz/~paul/RG2e/">book</a>
</li>
<li>
<a href="http://www.cookbook-r.com/Graphs/">R Cookbook</a> and <a href="http://shop.oreilly.com/product/0636920023135.do">R Graphics Cookbook</a>
</li>
</ul>
</div>
<div id="relevant-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#relevant-packages" class="anchor"></a>Relevant packages</h2>
<p>There are currently 137 <a href="http://bioconductor.org/packages/devel/BiocViews.html#___Proteomics">Proteomics</a> and 92 <a href="http://bioconductor.org/packages/devel/BiocViews.html#___MassSpectrometry">MassSpectrometry</a> packages in Bioconductor version 3.11. Other non-Bioconductor packages are described in the <code>r Biocexptpkg("RforProteomics")</code> vignette (open it in R with <code><a href="../reference/RforProteomics.html">RforProteomics()</a></code> or read it <a href="file:///home/lg390/dev/00_github/RforProteomics/docs/articles/RforProteomics.html">online</a>.)</p>
<div id="htmlwidget-a8c0da76f7eb5e003e40" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a8c0da76f7eb5e003e40">{"x":{"filter":"none","data":[["artMS","ASEB","AssessORF","bioassayR","biobroom","BioNetStat","biosigner","BRAIN","calm","Cardinal","CausalR","CellNOptR","ChemmineOB","ChemmineR","cisPath","cleaver","clippda","CNORdt","CNORfeeder","CNORode","customProDB","cydar","DAPAR","deco","deltaGseg","DEP","DEqMS","DIAlignR","diffcyt","DominoEffect","Doscheda","drawProteins","EGSEA","eiR","fCI","fmcsR","GraphPAC","HPAanalyze","hpar","IMMAN","InterMineR","iPAC","IPPD","isobar","kimod","KinSwingR","limma","LPEadj","MassSpecWavelet","MBQN","mitch","mixOmics","MsCoreUtils","MSGFgui","MSGFplus","msmsEDA","msmsTests","MSnbase","MSnID","MSstats","MSstatsQC","MSstatsQCgui","MSstatsSampleSize","MSstatsTMT","mzID","mzR","NormalyzerDE","NPARC","omicRexposome","OmicsLonDA","oppti","PAA","Path2PPI","pathview","pathwayPCA","PCpheno","PECA","pepXMLTab","PGA","pgca","phemd","phosphonormalizer","plgem","PLPE","PowerExplorer","ppiStats","PrInCE","proBAMr","proBatch","PROcess","procoil","proDA","proFIA","pRoloc","pRolocGUI","Prostar","ProteomicsAnnotationHubData","ProteoMM","ProtGenerics","pulsedSilac","Pviz","qcmetrics","qPLEXanalyzer","QuartPAC","rain","RankProd","RCASPAR","Rcpi","ReactomeGSA","ropls","ROTS","RpsiXML","rpx","rScudo","rTANDEM","sapFinder","SBGNview","ScISI","SDAMS","shinyTANDEM","SLGI","SMAD","SpacePAC","sparsenetgls","specL","statTarget","SubCellBarCode","SWATH2stats","synapter","timeOmics","tofsims","topdownr","TPP","TPP2D","XINA","proteoQC","readat"],["artMS","ASEB","AssessORF","bioassayR","biobroom","BioNetStat","biosigner","BRAIN","calm","Cardinal","CausalR","CellNOptR","ChemmineOB","ChemmineR","cisPath","cleaver","clippda","CNORdt","CNORfeeder","CNORode","customProDB","cydar","DAPAR","deco","deltaGseg","DEP","DEqMS","DIAlignR","diffcyt","DominoEffect","Doscheda","drawProteins","EGSEA","eiR","fCI","fmcsR","GraphPAC","HPAanalyze","hpar","IMMAN","InterMineR","iPAC","IPPD","isobar","kimod","KinSwingR","limma","LPEadj","MassSpecWavelet","MBQN","mitch","mixOmics","MsCoreUtils","MSGFgui","MSGFplus","msmsEDA","msmsTests","MSnbase","MSnID","MSstats","MSstatsQC","MSstatsQCgui","MSstatsSampleSize","MSstatsTMT","mzID","mzR","NormalyzerDE","NPARC","omicRexposome","OmicsLonDA","oppti","PAA","Path2PPI","pathview","pathwayPCA","PCpheno","PECA","pepXMLTab","PGA","pgca","phemd","phosphonormalizer","plgem","PLPE","PowerExplorer","ppiStats","PrInCE","proBAMr","proBatch","PROcess","procoil","proDA","proFIA","pRoloc","pRolocGUI","Prostar","ProteomicsAnnotationHubData","ProteoMM","ProtGenerics","pulsedSilac","Pviz","qcmetrics","qPLEXanalyzer","QuartPAC","rain","RankProd","RCASPAR","Rcpi","ReactomeGSA","ropls","ROTS","RpsiXML","rpx","rScudo","rTANDEM","sapFinder","SBGNview","ScISI","SDAMS","shinyTANDEM","SLGI","SMAD","SpacePAC","sparsenetgls","specL","statTarget","SubCellBarCode","SWATH2stats","synapter","timeOmics","tofsims","topdownr","TPP","TPP2D","XINA","proteoQC","readat"],["Analytical R tools for Mass Spectrometry","Predict Acetylated Lysine Sites","Assess Gene Predictions Using Proteomics and Evolutionary Conservation","Cross-target analysis of small molecule bioactivity","Turn Bioconductor objects into tidy data frames","Biological Network Analysis","Signature discovery from omics data","Baffling Recursive Algorithm for Isotope distributioN calculations","Covariate Assisted Large-scale Multiple testing","A mass spectrometry imaging toolbox for statistical analysis","Causal network analysis methods","Training of boolean logic models of signalling networks using prior knowledge networks and perturbation data","R interface to a subset of OpenBabel functionalities","Cheminformatics Toolkit for R","Visualization and management of the protein-protein interaction networks.","Cleavage of Polypeptide Sequences","A package for the clinical proteomic profiling data analysis","Add-on to CellNOptR: Discretized time treatments","Integration of CellNOptR to add missing links","ODE add-on to CellNOptR","Generate customized protein database from NGS data, with a focus on RNA-Seq data, for proteomics search","Using Mass Cytometry for Differential Abundance Analyses","Tools for the Differential Analysis of Proteins Abundance with R","Decomposing Heterogeneous Cohorts using Omic Data Profiling","deltaGseg","Differential Enrichment analysis of Proteomics data","a tool to perform statistical analysis of differential protein expression for quantitative proteomics data.","Dynamic Programming Based Alignment of MS2 Chromatograms","Differential discovery in high-dimensional cytometry via high-resolution clustering","Identification and Annotation of Protein Hotspot Residues","A DownStream Chemo-Proteomics Analysis Pipeline","Package to Draw Protein Schematics from Uniprot API output","Ensemble of Gene Set Enrichment Analyses","Accelerated similarity searching of small molecules","f-divergence Cutoff Index for Differential Expression Analysis in Transcriptomics and Proteomics","Mismatch Tolerant Maximum Common Substructure Searching","Identification of Mutational Clusters in Proteins via a Graph Theoretical Approach.","Retrieve and analyze data from the Human Protein Atlas","Human Protein Atlas in R","Interlog protein network reconstruction by Mapping and Mining ANalysis","R Interface with InterMine-Powered Databases","Identification of Protein Amino acid Clustering","Isotopic peak pattern deconvolution for Protein Mass Spectrometry by template matching","Analysis and quantitation of isobarically tagged MSMS proteomics data","A k-tables approach to integrate multiple Omics-Data","KinSwingR: network-based kinase activity prediction","Linear Models for Microarray Data","A correction of the local pooled error (LPE) method to replace the asymptotic variance adjustment with an unbiased adjustment\nbased on sample size.","Mass spectrum processing by wavelet-based algorithms","Mean/Median-balanced quantile normalization","Multi-Contrast Gene Set Enrichment Analysis","Omics Data Integration Project","Core Utils for Mass Spectrometry Data","A shiny GUI for MSGFplus","An interface between R and MS-GF+","Exploratory Data Analysis of LC-MS/MS data by spectral counts","LC-MS/MS Differential Expression Tests","Base Functions and Classes for Mass Spectrometry and Proteomics","Utilities for Exploration and Assessment of Confidence of LC-MSn Proteomics Identifications","Protein Significance Analysis in DDA, SRM and DIA for Label-free or Label-based Proteomics Experiments","Longitudinal system suitability monitoring and quality control for proteomic experiments","A graphical user interface for MSstatsQC package","Simulation tool for optimal design of high-dimensional MS-based proteomics experiment","Protein Significance Analysis in shotgun mass spectrometry-based proteomic experiments with tandem mass tag (TMT) labeling","An mzIdentML parser for R","parser for netCDF, mzXML, mzData and mzML and mzIdentML files (mass spectrometry data)","Evaluation of normalization methods and calculation of differential expression analysis statistics","Non-parametric analysis of response curves for thermal proteome profiling experiments","Exposome and omic data associatin and integration analysis","Omics Longitudinal Differential Analysis","Outlier Protein and Phosphosite Target Identifier","PAA (Protein Array Analyzer)","Prediction of pathway-related protein-protein interaction networks","a tool set for pathway based data integration and visualization","Integrative Pathway Analysis with Modern PCA Methodology and Gene Selection","Phenotypes and cellular organizational units","Probe-level Expression Change Averaging","Parsing pepXML files and filter based on peptide FDR.","An package for identification of novel peptides by customized database derived from RNA-Seq","PGCA: An Algorithm to Link Protein Groups Created from MS/MS Data","Phenotypic EMD for comparison of single-cell samples","Compensates for the bias introduced by median normalization in phosphoproteomics","Detect differential expression in microarray and proteomics datasets with the Power Law Global Error Model (PLGEM)","Local Pooled Error Test for Differential Expression with Paired High-throughput Data","Power Estimation Tool for RNA-Seq and proteomics data","Protein-Protein Interaction Statistical Package","Predicting Interactomes from Co-Elution","Generating SAM file for PSMs in shotgun proteomics data","Tools for Diagnostics and Corrections of Batch Effects in Proteomics","Ciphergen SELDI-TOF Processing","Prediction of Oligomerization of Coiled Coil Proteins","Differential Abundance Analysis of Label-Free Mass Spectrometry Data","Preprocessing of FIA-HRMS data","A unifying bioinformatics framework for spatial proteomics","Interactive visualisation of spatial proteomics data","Provides a GUI for DAPAR","Transform public proteomics data resources into Bioconductor Data Structures","Multi-Dataset Model-based Differential Expression Proteomics Analysis Platform","S4 generic functions for Bioconductor proteomics infrastructure","Analysis of pulsed-SILAC quantitative proteomics data","Peptide Annotation and Data Visualization using Gviz","A Framework for Quality Control","Tools for qPLEX-RIME data analysis","Identification of mutational clusters in protein quaternary structures.","Rhythmicity Analysis Incorporating Non-parametric Methods","Rank Product method for identifying differentially expressed genes with application in meta-analysis","A package for survival time prediction based on a piecewise baseline hazard Cox regression model.","Molecular Informatics Toolkit for Compound-Protein Interaction in Drug Discovery","Client for the Reactome Analysis Service for comparative multi-omics gene set analysis","PCA, PLS(-DA) and OPLS(-DA) for multivariate analysis and feature selection of omics data","Reproducibility-Optimized Test Statistic","R interface to PSI-MI 2.5 files","R Interface to the ProteomeXchange Repository","Signature-based Clustering for Diagnostic Purposes","Interfaces the tandem protein identification algorithm in R","A package for variant peptides detection and visualization in shotgun proteomics.","Overlay omics data onto SBGN pathway diagram","In Silico Interactome","Differential Abundant Analysis for Metabolomics and Proteomics Data","Provides a GUI for rTANDEM","Synthetic Lethal Genetic Interaction","Statistical Modelling of AP-MS Data (SMAD)","Identification of Mutational Clusters in 3D Protein Space via Simulation.","Using Gaussian graphical structue learning estimation in generalized least squared regression for multivariate normal\nregression","specL - Prepare Peptide Spectrum Matches for Use in Targeted Proteomics","Statistical Analysis of Molecular Profiles","SubCellBarCode: Integrated workflow for robust mapping and visualizing whole human spatial proteome","Transform and Filter SWATH Data for Statistical Packages","Label-free data analysis pipeline for optimal identification and quantitation","Time-Course Multi-Omics data integration","Import, process and analysis of Time-of-Flight Secondary Ion Mass Spectrometry (ToF-SIMS) imaging data","Investigation of Fragmentation Conditions in Top-Down Proteomics","Analyze thermal proteome profiling (TPP) experiments","Detection of ligand-protein interactions from 2D thermal profiles (DLPTP)","Multiplexes Isobaric Mass Tagged-based Kinetics Data for Network Analysis","An R package for proteomics data quality control","Functionality to Read and Manipulate SomaLogic ADAT files"],["1.6.5","1.32.0","1.6.0","1.26.0","1.20.0","1.8.4","1.16.0","1.34.0","1.2.0","2.6.0","1.20.0","1.34.0","1.26.0","3.40.0","1.28.0","1.26.1","1.38.0","1.30.0","1.28.0","1.30.0","1.28.0","1.12.0","1.20.2","1.4.0","1.28.0","1.10.0","1.6.0","1.0.5","1.8.6","1.8.0","1.10.0","1.8.0","1.16.0","1.28.0","1.18.0","1.30.0","1.30.0","1.6.0","1.30.0","1.7.0","1.10.0","1.32.0","1.35.0","1.34.0","1.15.0","1.6.0","3.44.2","1.48.0","1.54.0","2.0.2","1.0.4","6.12.1","1.0.0","1.22.0","1.22.0","1.26.0","1.26.0","2.14.2","1.22.0","3.20.0","2.6.0","1.8.0","1.2.0","1.6.3","1.26.0","2.22.0","1.6.0","1.0.1","1.10.0","1.4.0","1.2.0","1.22.0","1.18.0","1.28.0","1.4.0","1.50.0","1.24.0","1.22.0","1.18.0","1.12.0","1.4.0","1.12.0","1.60.0","1.48.0","1.7.0","1.54.0","1.4.0","1.22.0","1.4.0","1.64.0","2.16.0","1.2.0","1.14.0","1.28.0","1.22.0","1.20.0","1.18.0","1.6.0","1.20.0","1.2.0","1.22.0","1.26.0","1.6.0","1.20.0","1.22.0","3.14.0","1.34.0","1.24.0","1.2.2","1.20.0","1.16.0","2.30.0","1.24.0","1.4.0","1.27.0","1.26.0","1.2.0","1.60.0","1.8.0","1.26.0","1.48.0","1.4.0","1.26.0","1.6.0","1.22.0","1.18.0","1.4.0","1.18.0","2.12.0","1.0.1","1.16.0","1.10.0","3.16.2","1.4.0","1.6.0","1.24.0","1.14.0"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Package<\/th>\n      <th>Title<\/th>\n      <th>Version<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script><div id="htmlwidget-e83f33b366d8f7e87e89" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e83f33b366d8f7e87e89">{"x":{"filter":"none","data":[["adductomicsR","apComplex","artMS","Autotuner","BRAIN","CAMERA","Cardinal","CATALYST","cliqueMS","cosmiq","customProDB","DAPAR","DEP","DEqMS","DIAlignR","Doscheda","flagme","gaga","INDEED","IPO","isobar","IsoCorrectoR","IsoCorrectoRGUI","lipidr","LOBSTAHS","MAIT","MassArray","MassSpecWavelet","Metab","metabomxtr","metaMS","MetCirc","MetNet","MsCoreUtils","MSGFgui","MSGFplus","msmsEDA","msmsTests","MSnbase","MSnID","msPurity","MSstats","MSstatsQC","MSstatsQCgui","MSstatsSampleSize","MSstatsTMT","mzID","mzR","ncGTW","peakPantheR","pepXMLTab","PGA","pgca","plgem","pmp","proBAMr","proBatch","PROcess","proDA","proFIA","pRoloc","Prostar","ProteoMM","ProtGenerics","qcmetrics","qPLEXanalyzer","Rdisop","Risa","RMassBank","rols","ropls","rpx","rTANDEM","sapFinder","SDAMS","shinyTANDEM","SIMAT","SMAD","sparsenetgls","specL","statTarget","SubCellBarCode","SWATH2stats","synapter","TargetSearch","tofsims","topdownr","TPP","xcms","yamss","PAPi","proteoQC"],["adductomicsR","apComplex","artMS","Autotuner","BRAIN","CAMERA","Cardinal","CATALYST","cliqueMS","cosmiq","customProDB","DAPAR","DEP","DEqMS","DIAlignR","Doscheda","flagme","gaga","INDEED","IPO","isobar","IsoCorrectoR","IsoCorrectoRGUI","lipidr","LOBSTAHS","MAIT","MassArray","MassSpecWavelet","Metab","metabomxtr","metaMS","MetCirc","MetNet","MsCoreUtils","MSGFgui","MSGFplus","msmsEDA","msmsTests","MSnbase","MSnID","msPurity","MSstats","MSstatsQC","MSstatsQCgui","MSstatsSampleSize","MSstatsTMT","mzID","mzR","ncGTW","peakPantheR","pepXMLTab","PGA","pgca","plgem","pmp","proBAMr","proBatch","PROcess","proDA","proFIA","pRoloc","Prostar","ProteoMM","ProtGenerics","qcmetrics","qPLEXanalyzer","Rdisop","Risa","RMassBank","rols","ropls","rpx","rTANDEM","sapFinder","SDAMS","shinyTANDEM","SIMAT","SMAD","sparsenetgls","specL","statTarget","SubCellBarCode","SWATH2stats","synapter","TargetSearch","tofsims","topdownr","TPP","xcms","yamss","PAPi","proteoQC"],["Processing of adductomic mass spectral datasets","Estimate protein complex membership using AP-MS protein data","Analytical R tools for Mass Spectrometry","Automated parameter selection for untargeted metabolomics data processing","Baffling Recursive Algorithm for Isotope distributioN calculations","Collection of annotation related methods for mass spectrometry data","A mass spectrometry imaging toolbox for statistical analysis","Cytometry dATa anALYSis Tools","Annotation of Isotopes, Adducts and Fragmentation Adducts for in-Source LC/MS Metabolomics Data","cosmiq - COmbining Single Masses Into Quantities","Generate customized protein database from NGS data, with a focus on RNA-Seq data, for proteomics search","Tools for the Differential Analysis of Proteins Abundance with R","Differential Enrichment analysis of Proteomics data","a tool to perform statistical analysis of differential protein expression for quantitative proteomics data.","Dynamic Programming Based Alignment of MS2 Chromatograms","A DownStream Chemo-Proteomics Analysis Pipeline","Analysis of Metabolomics GC/MS Data","GaGa hierarchical model for high-throughput data analysis","Interactive Visualization of Integrated Differential Expression and Differential Network Analysis for Biomarker Candidate\nSelection Package","Automated Optimization of XCMS Data Processing parameters","Analysis and quantitation of isobarically tagged MSMS proteomics data","Correction for natural isotope abundance and tracer purity in MS and MS/MS data from stable isotope labeling experiments","Graphical User Interface for IsoCorrectoR","Data Mining and Analysis of Lipidomics Datasets","Lipid and Oxylipin Biomarker Screening through Adduct Hierarchy Sequences","Statistical Analysis of Metabolomic Data","Analytical Tools for MassArray Data","Mass spectrum processing by wavelet-based algorithms","Metab: An R Package for a High-Throughput Analysis of Metabolomics Data Generated by GC-MS.","A package to run mixture models for truncated metabolomics data with normal or lognormal distributions","MS-based metabolomics annotation pipeline","Navigating mass spectral similarity in high-resolution MS/MS metabolomics data","Inferring metabolic networks from untargeted high-resolution mass spectrometry data","Core Utils for Mass Spectrometry Data","A shiny GUI for MSGFplus","An interface between R and MS-GF+","Exploratory Data Analysis of LC-MS/MS data by spectral counts","LC-MS/MS Differential Expression Tests","Base Functions and Classes for Mass Spectrometry and Proteomics","Utilities for Exploration and Assessment of Confidence of LC-MSn Proteomics Identifications","Automated Evaluation of Precursor Ion Purity for Mass Spectrometry Based Fragmentation in Metabolomics","Protein Significance Analysis in DDA, SRM and DIA for Label-free or Label-based Proteomics Experiments","Longitudinal system suitability monitoring and quality control for proteomic experiments","A graphical user interface for MSstatsQC package","Simulation tool for optimal design of high-dimensional MS-based proteomics experiment","Protein Significance Analysis in shotgun mass spectrometry-based proteomic experiments with tandem mass tag (TMT) labeling","An mzIdentML parser for R","parser for netCDF, mzXML, mzData and mzML and mzIdentML files (mass spectrometry data)","Alignment of LC-MS Profiles by Neighbor-wise Compound-specific Graphical Time Warping with Misalignment Detection","Peak Picking and Annotation of High Resolution Experiments","Parsing pepXML files and filter based on peptide FDR.","An package for identification of novel peptides by customized database derived from RNA-Seq","PGCA: An Algorithm to Link Protein Groups Created from MS/MS Data","Detect differential expression in microarray and proteomics datasets with the Power Law Global Error Model (PLGEM)","Peak Matrix Processing and signal batch correction for metabolomics datasets","Generating SAM file for PSMs in shotgun proteomics data","Tools for Diagnostics and Corrections of Batch Effects in Proteomics","Ciphergen SELDI-TOF Processing","Differential Abundance Analysis of Label-Free Mass Spectrometry Data","Preprocessing of FIA-HRMS data","A unifying bioinformatics framework for spatial proteomics","Provides a GUI for DAPAR","Multi-Dataset Model-based Differential Expression Proteomics Analysis Platform","S4 generic functions for Bioconductor proteomics infrastructure","A Framework for Quality Control","Tools for qPLEX-RIME data analysis","Decomposition of Isotopic Patterns","Converting experimental metadata from ISA-tab into Bioconductor data structures","Workflow to process tandem MS files and build MassBank records","An R interface to the Ontology Lookup Service","PCA, PLS(-DA) and OPLS(-DA) for multivariate analysis and feature selection of omics data","R Interface to the ProteomeXchange Repository","Interfaces the tandem protein identification algorithm in R","A package for variant peptides detection and visualization in shotgun proteomics.","Differential Abundant Analysis for Metabolomics and Proteomics Data","Provides a GUI for rTANDEM","GC-SIM-MS data processing and alaysis tool","Statistical Modelling of AP-MS Data (SMAD)","Using Gaussian graphical structue learning estimation in generalized least squared regression for multivariate normal\nregression","specL - Prepare Peptide Spectrum Matches for Use in Targeted Proteomics","Statistical Analysis of Molecular Profiles","SubCellBarCode: Integrated workflow for robust mapping and visualizing whole human spatial proteome","Transform and Filter SWATH Data for Statistical Packages","Label-free data analysis pipeline for optimal identification and quantitation","A package for the analysis of GC-MS metabolite profiling data","Import, process and analysis of Time-of-Flight Secondary Ion Mass Spectrometry (ToF-SIMS) imaging data","Investigation of Fragmentation Conditions in Top-Down Proteomics","Analyze thermal proteome profiling (TPP) experiments","LC-MS and GC-MS Data Analysis","Tools for high-throughput metabolomics","Predict metabolic pathway activity based on metabolomics data","An R package for proteomics data quality control"],["1.4.0","2.54.0","1.6.5","1.2.0","1.34.0","1.44.0","2.6.0","1.12.1","1.2.0","1.22.0","1.28.0","1.20.2","1.10.0","1.6.0","1.0.5","1.10.0","1.44.0","2.34.0","2.2.0","1.14.0","1.34.0","1.6.0","1.4.0","2.2.0","1.14.0","1.21.0","1.40.0","1.54.0","1.22.0","1.22.0","1.24.0","1.18.0","1.6.0","1.0.0","1.22.0","1.22.0","1.26.0","1.26.0","2.14.2","1.22.0","1.14.0","3.20.0","2.6.0","1.8.0","1.2.0","1.6.3","1.26.0","2.22.0","1.2.0","1.2.0","1.22.0","1.18.0","1.12.0","1.60.0","1.0.0","1.22.0","1.4.0","1.64.0","1.2.0","1.14.0","1.28.0","1.20.0","1.6.0","1.20.0","1.26.0","1.6.0","1.48.0","1.30.0","2.16.0","2.16.2","1.20.0","1.24.0","1.27.0","1.26.0","1.8.0","1.26.0","1.20.0","1.4.0","1.6.0","1.22.0","1.18.0","1.4.0","1.18.0","2.12.0","1.44.0","1.16.0","1.10.0","3.16.2","3.10.1","1.14.0","1.28.0","1.24.0"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Package<\/th>\n      <th>Title<\/th>\n      <th>Version<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="ascombes-quartet" class="section level1">
<h1 class="hasAnchor">
<a href="#ascombes-quartet" class="anchor"></a>Ascombe's quartet</h1>
<table class="table">
<thead><tr>
<th style="text-align:right;">
x1
</th>
<th style="text-align:right;">
x2
</th>
<th style="text-align:right;">
x3
</th>
<th style="text-align:right;">
x4
</th>
<th style="text-align:right;">
y1
</th>
<th style="text-align:right;">
y2
</th>
<th style="text-align:right;">
y3
</th>
<th style="text-align:right;">
y4
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8.04
</td>
<td style="text-align:right;">
9.14
</td>
<td style="text-align:right;">
7.46
</td>
<td style="text-align:right;">
6.58
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6.95
</td>
<td style="text-align:right;">
8.14
</td>
<td style="text-align:right;">
6.77
</td>
<td style="text-align:right;">
5.76
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7.58
</td>
<td style="text-align:right;">
8.74
</td>
<td style="text-align:right;">
12.74
</td>
<td style="text-align:right;">
7.71
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8.81
</td>
<td style="text-align:right;">
8.77
</td>
<td style="text-align:right;">
7.11
</td>
<td style="text-align:right;">
8.84
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8.33
</td>
<td style="text-align:right;">
9.26
</td>
<td style="text-align:right;">
7.81
</td>
<td style="text-align:right;">
8.47
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9.96
</td>
<td style="text-align:right;">
8.10
</td>
<td style="text-align:right;">
8.84
</td>
<td style="text-align:right;">
7.04
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7.24
</td>
<td style="text-align:right;">
6.13
</td>
<td style="text-align:right;">
6.08
</td>
<td style="text-align:right;">
5.25
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
4.26
</td>
<td style="text-align:right;">
3.10
</td>
<td style="text-align:right;">
5.39
</td>
<td style="text-align:right;">
12.50
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
10.84
</td>
<td style="text-align:right;">
9.13
</td>
<td style="text-align:right;">
8.15
</td>
<td style="text-align:right;">
5.56
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
4.82
</td>
<td style="text-align:right;">
7.26
</td>
<td style="text-align:right;">
6.42
</td>
<td style="text-align:right;">
7.91
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
5.68
</td>
<td style="text-align:right;">
4.74
</td>
<td style="text-align:right;">
5.73
</td>
<td style="text-align:right;">
6.89
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><html><body><pre class="r"><span class="no">tab</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>, <span class="fl">5</span>, <span class="fl">4</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">tab</span>) <span class="kw">&lt;-</span> <span class="fl">1</span>:<span class="fl">4</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">tab</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"var(x)"</span>, <span class="st">"mean(x)"</span>,
                   <span class="st">"var(y)"</span>, <span class="st">"mean(y)"</span>,
                   <span class="st">"cor(x,y)"</span>)

<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">4</span>)
    <span class="no">tab</span>[, <span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span>(<span class="no">anscombe</span>[, <span class="no">i</span>]),
                  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">anscombe</span>[, <span class="no">i</span>]),
                  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span>(<span class="no">anscombe</span>[, <span class="no">i</span>+<span class="fl">4</span>]),
                  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">anscombe</span>[, <span class="no">i</span>+<span class="fl">4</span>]),
                  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">anscombe</span>[, <span class="no">i</span>], <span class="no">anscombe</span>[, <span class="no">i</span>+<span class="fl">4</span>]))</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>var(x)</td>
<td align="right">11.0000000</td>
<td align="right">11.0000000</td>
<td align="right">11.0000000</td>
<td align="right">11.0000000</td>
</tr>
<tr class="even">
<td>mean(x)</td>
<td align="right">9.0000000</td>
<td align="right">9.0000000</td>
<td align="right">9.0000000</td>
<td align="right">9.0000000</td>
</tr>
<tr class="odd">
<td>var(y)</td>
<td align="right">4.1272691</td>
<td align="right">4.1276291</td>
<td align="right">4.1226200</td>
<td align="right">4.1232491</td>
</tr>
<tr class="even">
<td>mean(y)</td>
<td align="right">7.5009091</td>
<td align="right">7.5009091</td>
<td align="right">7.5000000</td>
<td align="right">7.5009091</td>
</tr>
<tr class="odd">
<td>cor(x,y)</td>
<td align="right">0.8164205</td>
<td align="right">0.8162365</td>
<td align="right">0.8162867</td>
<td align="right">0.8165214</td>
</tr>
</tbody>
</table>
<p>While the residuals of the linear regression clearly indicate fundamental differences in these data, the most simple and straightforward approach is visualisation to highlight the fundamental differences in the datasets.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">ff</span> <span class="kw">&lt;-</span> <span class="no">y</span> ~ <span class="no">x</span>

<span class="no">mods</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span>(<span class="fl">1</span>:<span class="fl">4</span>), <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"lm"</span>, <span class="fl">1</span>:<span class="fl">4</span>))

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>), <span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span>))
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">4</span>) {
    <span class="no">ff</span>[<span class="fl">2</span>:<span class="fl">3</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y"</span>,<span class="st">"x"</span>), <span class="no">i</span>), <span class="no">as.name</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">ff</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">anscombe</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">19</span>, <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">19</span>), <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">13</span>))
    <span class="no">mods</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="no">ff</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">anscombe</span>)
    <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="no">mods</span><span class="kw">[[</span><span class="no">i</span>]])
}</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/anscombefig-1.png" width="700"></p>
<table class="table">
<thead><tr class="header">
<th align="right">lm1</th>
<th align="right">lm2</th>
<th align="right">lm3</th>
<th align="right">lm4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0390000</td>
<td align="right">1.1390909</td>
<td align="right">-0.5397273</td>
<td align="right">-0.421</td>
</tr>
<tr class="even">
<td align="right">-0.0508182</td>
<td align="right">1.1390909</td>
<td align="right">-0.2302727</td>
<td align="right">-1.241</td>
</tr>
<tr class="odd">
<td align="right">-1.9212727</td>
<td align="right">-0.7609091</td>
<td align="right">3.2410909</td>
<td align="right">0.709</td>
</tr>
<tr class="even">
<td align="right">1.3090909</td>
<td align="right">1.2690909</td>
<td align="right">-0.3900000</td>
<td align="right">1.839</td>
</tr>
<tr class="odd">
<td align="right">-0.1710909</td>
<td align="right">0.7590909</td>
<td align="right">-0.6894545</td>
<td align="right">1.469</td>
</tr>
<tr class="even">
<td align="right">-0.0413636</td>
<td align="right">-1.9009091</td>
<td align="right">-1.1586364</td>
<td align="right">0.039</td>
</tr>
<tr class="odd">
<td align="right">1.2393636</td>
<td align="right">0.1290909</td>
<td align="right">0.0791818</td>
<td align="right">-1.751</td>
</tr>
<tr class="even">
<td align="right">-0.7404545</td>
<td align="right">-1.9009091</td>
<td align="right">0.3886364</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="right">1.8388182</td>
<td align="right">0.1290909</td>
<td align="right">-0.8491818</td>
<td align="right">-1.441</td>
</tr>
<tr class="even">
<td align="right">-1.6807273</td>
<td align="right">0.7590909</td>
<td align="right">-0.0805455</td>
<td align="right">0.909</td>
</tr>
<tr class="odd">
<td align="right">0.1794545</td>
<td align="right">-0.7609091</td>
<td align="right">0.2289091</td>
<td align="right">-0.111</td>
</tr>
</tbody>
</table>
</div>
<div id="the-ma-plot-example" class="section level1">
<h1 class="hasAnchor">
<a href="#the-ma-plot-example" class="anchor"></a>The MA plot example</h1>
<p>The following code chunk connects to the <code>PXD000001</code> data set on the ProteomeXchange repository and fetches the <code>mzTab</code> file. After missing values filtering, we extract relevant data (log2 fold-changes and log10 mean expression intensities) into <code>data.frames</code>.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"rpx"</span>)
<span class="no">px1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpx/man/PXDataset-class.html">PXDataset</a></span>(<span class="st">"PXD000001"</span>)
<span class="no">mztab</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpx/man/PXDataset-class.html">pxget</a></span>(<span class="no">px1</span>, <span class="st">"PXD000001_mztab.txt"</span>)</pre></body></html></div>
<pre><code>## Downloading 1 file</code></pre>
<pre><code>## /home/lgatto/wrk/RforProteomics/vignettes/PXD000001_mztab.txt already present.</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"MSnbase"</span>)
<span class="co">## here, we need to specify the (old) mzTab version 0.9</span>
<span class="no">qnt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/readMzTabData.html">readMzTabData</a></span>(<span class="no">mztab</span>, <span class="kw">what</span> <span class="kw">=</span> <span class="st">"PEP"</span>, <span class="kw">version</span> <span class="kw">=</span> <span class="st">"0.9"</span>)
<span class="fu">sampleNames</span>(<span class="no">qnt</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/ReporterIons-class.html">reporterNames</a></span>(<span class="no">TMT6</span>)
<span class="no">qnt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/MSnSet-class.html">filterNA</a></span>(<span class="no">qnt</span>)
<span class="co">## may be combineFeatuers</span>

<span class="no">spikes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"P02769"</span>, <span class="st">"P00924"</span>, <span class="st">"P62894"</span>, <span class="st">"P00489"</span>)
<span class="no">protclasses</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="fu">fData</span>(<span class="no">qnt</span>)$<span class="no">accession</span>)
<span class="no">protclasses</span>[!<span class="no">protclasses</span> <span class="kw">%in%</span> <span class="no">spikes</span>] <span class="kw">&lt;-</span> <span class="st">"Background"</span>


<span class="no">madata42</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">A</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fu">exprs</span>(<span class="no">qnt</span>[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">2</span>)]), <span class="fl">10</span>)),
                       <span class="kw">M</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fu">exprs</span>(<span class="no">qnt</span>)[, <span class="fl">4</span>], <span class="fl">2</span>) - <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fu">exprs</span>(<span class="no">qnt</span>)[, <span class="fl">2</span>], <span class="fl">2</span>),
                       <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"4vs2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">qnt</span>)),
                       <span class="kw">protein</span> <span class="kw">=</span> <span class="fu">fData</span>(<span class="no">qnt</span>)$<span class="no">accession</span>,
                       <span class="kw">class</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">protclasses</span>))

<span class="no">madata62</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">A</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fu">exprs</span>(<span class="no">qnt</span>[, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">6</span>, <span class="fl">2</span>)]), <span class="fl">10</span>)),
                       <span class="kw">M</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fu">exprs</span>(<span class="no">qnt</span>)[, <span class="fl">6</span>], <span class="fl">2</span>) - <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fu">exprs</span>(<span class="no">qnt</span>)[, <span class="fl">2</span>], <span class="fl">2</span>),
                       <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"6vs2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">qnt</span>)),
                       <span class="kw">protein</span> <span class="kw">=</span> <span class="fu">fData</span>(<span class="no">qnt</span>)$<span class="no">accession</span>,
                       <span class="kw">class</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">protclasses</span>))


<span class="no">madata</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="no">madata42</span>, <span class="no">madata62</span>)</pre></body></html></div>
<div id="the-traditional-plotting-system" class="section level2">
<h2 class="hasAnchor">
<a href="#the-traditional-plotting-system" class="anchor"></a>The traditional plotting system</h2>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">M</span> ~ <span class="no">A</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">madata42</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"4vs2"</span>,
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"A"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"M"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="no">madata62</span>$<span class="no">class</span>)
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">M</span> ~ <span class="no">A</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">madata62</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"6vs2"</span>,
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"A"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"M"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="no">madata62</span>$<span class="no">class</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/mafig1-1.png" width="700"></p>
</div>
<div id="lattice" class="section level2">
<h2 class="hasAnchor">
<a href="#lattice" class="anchor"></a>lattice</h2>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"lattice"</span>)
<span class="no">latma</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html">xyplot</a></span>(<span class="no">M</span> ~ <span class="no">A</span> <span class="kw">|</span> <span class="no">data</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">madata</span>,
                <span class="kw">groups</span> <span class="kw">=</span> <span class="no">madata</span>$<span class="no">class</span>,
                <span class="kw">auto.key</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">latma</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/mafig2-1.png" width="700"></p>
</div>
<div id="ggplot2" class="section level2">
<h2 class="hasAnchor">
<a href="#ggplot2" class="anchor"></a>ggplot2</h2>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ggplot2"</span>)
<span class="no">ggma</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">A</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">M</span>, <span class="kw">colour</span> <span class="kw">=</span> <span class="no">class</span>), <span class="kw">data</span> <span class="kw">=</span> <span class="no">madata</span>,
               <span class="kw">colour</span> <span class="kw">=</span> <span class="no">class</span>) +
                   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() +
                       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(<span class="no">.</span> ~ <span class="no">data</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">ggma</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/mafig3-1.png" width="700"></p>
</div>
<div id="customization" class="section level2">
<h2 class="hasAnchor">
<a href="#customization" class="anchor"></a>Customization</h2>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"RColorBrewer"</span>)
<span class="no">bcols</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span>(<span class="fl">4</span>, <span class="st">"Set1"</span>)
<span class="no">cls</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Background"</span> <span class="kw">=</span> <span class="st">"#12121230"</span>,
         <span class="st">"P02769"</span> <span class="kw">=</span> <span class="no">bcols</span>[<span class="fl">1</span>],
         <span class="st">"P00924"</span> <span class="kw">=</span> <span class="no">bcols</span>[<span class="fl">2</span>],
         <span class="st">"P62894"</span> <span class="kw">=</span> <span class="no">bcols</span>[<span class="fl">3</span>],
         <span class="st">"P00489"</span> <span class="kw">=</span> <span class="no">bcols</span>[<span class="fl">4</span>])</pre></body></html></div>
<div class="sourceCode"><html><body><pre class="r"><span class="no">ggma2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">A</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">M</span>, <span class="kw">colour</span> <span class="kw">=</span> <span class="no">class</span>),
                <span class="kw">data</span> <span class="kw">=</span> <span class="no">madata</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">shape</span> <span class="kw">=</span> <span class="fl">19</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(<span class="no">.</span> ~ <span class="no">data</span>) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual</a></span>(<span class="kw">values</span> <span class="kw">=</span> <span class="no">cls</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span>(<span class="kw">colour</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span>(<span class="kw">override.aes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">1</span>)))
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">ggma2</span>)</pre></body></html></div>
<pre><code>## Warning in grid.Call.graphics(C_points, x$x, x$y, x$pch, x$size): semi-
## transparency is not supported on this device: reported only once per page</code></pre>
<p><img src="RProtVis_files/figure-html/macust-1.png" width="700"></p>
</div>
<div id="the-maplot-method-for-msnset-instances" class="section level2">
<h2 class="hasAnchor">
<a href="#the-maplot-method-for-msnset-instances" class="anchor"></a>The <code>MAplot</code> method for <code>MSnSet</code> instances</h2>
<div class="sourceCode"><html><body><pre class="r"><span class="fu">MAplot</span>(<span class="no">qnt</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">.8</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/mafigmsnset-1.png" width="700"></p>
</div>
<div id="an-interactive-shiny-app-for-ma-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#an-interactive-shiny-app-for-ma-plots" class="anchor"></a>An interactive <em><a href="https://CRAN.R-project.org/package=shiny">shiny</a></em> app for MA plots</h2>
<p>This app is based on Mike Love's <a href="https://github.com/mikelove/shinyMA">shinyMA</a> application, adapted for a proteomics data. A screen shot is displayed below. To start the application:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="../reference/shinyMA.html">shinyMA</a></span>()</pre></body></html></div>
<div class="figure">
<img src="figures/shinyMA.png" alt="shinyMA screeshot"><p class="caption">shinyMA screeshot</p>
</div>
<p>The application is also available online at <a href="https://lgatto.shinyapps.io/shinyMA/" class="uri">https://lgatto.shinyapps.io/shinyMA/</a>.</p>
<p>See the excellent <em><a href="https://CRAN.R-project.org/package=shiny">shiny</a></em> <a href="http://shiny.rstudio.com/">web page</a> for tutorials.</p>
</div>
<div id="volcano-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#volcano-plots" class="anchor"></a>Volcano plots</h2>
<p>Below, using the <em><a href="https://bioconductor.org/packages/3.11/msmsTest">msmsTest</a></em> package, we load a example <code>MSnSet</code> data with spectral couting data (from the <code>r Biocpkg("msmsEDA")</code> package) and run a statistical test to obtain (adjusted) p-values and fold-changes.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"msmsEDA"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"msmsTests"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">msms.dataset</span>)
<span class="co">## Pre-process expression matrix</span>
<span class="no">e</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/msmsEDA/man/pp.msms.data.html">pp.msms.data</a></span>(<span class="no">msms.dataset</span>)
<span class="co">## Models and normalizing condition</span>
<span class="no">null.f</span> <span class="kw">&lt;-</span> <span class="st">"y~batch"</span>
<span class="no">alt.f</span> <span class="kw">&lt;-</span> <span class="st">"y~treat+batch"</span>
<span class="no">div</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/tidyeval.html">exprs</a></span>(<span class="no">e</span>), <span class="fl">2</span>, <span class="no">sum</span>)
<span class="co">## Test</span>
<span class="no">res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/msmsTests/man/msms.glm.qlll.html">msms.glm.qlll</a></span>(<span class="no">e</span>, <span class="no">alt.f</span>, <span class="no">null.f</span>, <span class="kw">div</span> <span class="kw">=</span> <span class="no">div</span>)
<span class="no">lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/msmsTests/man/test.results.html">test.results</a></span>(<span class="no">res</span>, <span class="no">e</span>, <span class="fu">pData</span>(<span class="no">e</span>)$<span class="no">treat</span>, <span class="st">"U600"</span>, <span class="st">"U200 "</span>, <span class="no">div</span>,
                    <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.05</span>, <span class="kw">minSpC</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">minLFC</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="fl">1.8</span>),
                    <span class="kw">method</span> <span class="kw">=</span> <span class="st">"BH"</span>)</pre></body></html></div>
<p>Here, we produce the volcano plot by hand, with the <code>plot</code> function. In the second plot, we limit the x axis limits and add grid lines.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">lst</span>$<span class="no">tres</span>$<span class="no">LogFC</span>, -<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">lst</span>$<span class="no">tres</span>$<span class="no">p.value</span>))</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/volc1-1.png" width="700"></p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">lst</span>$<span class="no">tres</span>$<span class="no">LogFC</span>, -<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">lst</span>$<span class="no">tres</span>$<span class="no">p.value</span>),
     <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">3</span>, <span class="fl">3</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span>()</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/volc1-2.png" width="700"></p>
<p>Below, we use the <code>res.volcanoplot</code> function from the <code>r Biocpkg("msmsTests")</code> package. This functions uses the sample annotation stored with the quantitative data in the <code>MSnSet</code> object to colour the samples according to their phenotypes.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="co">## Plot</span>
<span class="fu"><a href="https://rdrr.io/pkg/msmsTests/man/res.volcanoplot.html">res.volcanoplot</a></span>(<span class="no">lst</span>$<span class="no">tres</span>,
                <span class="kw">max.pval</span> <span class="kw">=</span> <span class="fl">0.05</span>,
                <span class="kw">min.LFC</span> <span class="kw">=</span> <span class="fl">1</span>,
                <span class="kw">maxx</span> <span class="kw">=</span> <span class="fl">3</span>,
                <span class="kw">maxy</span> <span class="kw">=</span> <span class="kw">NULL</span>,
                <span class="kw">ylbls</span> <span class="kw">=</span> <span class="fl">4</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/volc2-1.png" width="700"></p>
</div>
<div id="a-pca-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#a-pca-plot" class="anchor"></a>A PCA plot</h2>
<p>Using the <code>counts.pca</code> function from the <em><a href="https://bioconductor.org/packages/3.11/msmsEDA">msmsEDA</a></em> package:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"msmsEDA"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">msms.dataset</span>)
<span class="no">msnset</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/msmsEDA/man/pp.msms.data.html">pp.msms.data</a></span>(<span class="no">msms.dataset</span>)
<span class="no">lst</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/msmsEDA/man/counts.pca.html">counts.pca</a></span>(<span class="no">msnset</span>, <span class="kw">wait</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/msmsedapca-1.png" width="700"><img src="RProtVis_files/figure-html/msmsedapca-2.png" width="700"></p>
<p>It is also possible to generate the PCA data using the <code>prcomp</code>. Below, we extract the coordinates of PC1 and PC2 from the <code>counts.pca</code> result and plot them using the <code>plot</code> function.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">pcadata</span> <span class="kw">&lt;-</span> <span class="no">lst</span>$<span class="no">pca</span>$<span class="no">x</span>[, <span class="fl">1</span>:<span class="fl">2</span>]
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">pcadata</span>)</pre></body></html></div>
<pre><code>##                  PC1       PC2
## U2.2502.1 -120.26080 -53.55270
## U2.2502.2  -99.90618 -53.89979
## U2.2502.3 -127.35928 -49.29906
## U2.2502.4 -166.04611 -39.27557
## U6.2502.1 -127.18423  37.11614
## U6.2502.2 -117.97016  47.03702</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">pcadata</span>[, <span class="fl">1</span>], <span class="no">pcadata</span>[, <span class="fl">2</span>],
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"PCA1"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"PCA2"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span>()</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/pca-1.png" width="700"></p>
</div>
</div>
<div id="plotting-with-r" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-with-r" class="anchor"></a>Plotting with R</h1>
<div class="sourceCode"><html><body><pre class="r"><span class="fu">kable</span>(<span class="no">plotfuns</span>)</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">plot type</th>
<th align="left">traditional</th>
<th align="left">lattice</th>
<th align="left">ggplot2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">scatterplots</td>
<td align="left">plot</td>
<td align="left">xyplot</td>
<td align="left">geom_point</td>
</tr>
<tr class="even">
<td align="left">histograms</td>
<td align="left">hist</td>
<td align="left">histgram</td>
<td align="left">geom_histogram</td>
</tr>
<tr class="odd">
<td align="left">density plots</td>
<td align="left">plot(density())</td>
<td align="left">densityplot</td>
<td align="left">geom_density</td>
</tr>
<tr class="even">
<td align="left">boxplots</td>
<td align="left">boxplot</td>
<td align="left">bwplot</td>
<td align="left">geom_boxplot</td>
</tr>
<tr class="odd">
<td align="left">violin plots</td>
<td align="left">vioplot::vioplot</td>
<td align="left">bwplot(..., panel = panel.violin)</td>
<td align="left">geom_violin</td>
</tr>
<tr class="even">
<td align="left">line plots</td>
<td align="left">plot, matplot</td>
<td align="left">xyploy, parallelplot</td>
<td align="left">geom_line</td>
</tr>
<tr class="odd">
<td align="left">bar plots</td>
<td align="left">barplot</td>
<td align="left">barchart</td>
<td align="left">geom_bar</td>
</tr>
<tr class="even">
<td align="left">pie charts</td>
<td align="left">pie</td>
<td align="left"></td>
<td align="left">geom_bar with polar coordinates</td>
</tr>
<tr class="odd">
<td align="left">dot plots</td>
<td align="left">dotchart</td>
<td align="left">dotplot</td>
<td align="left">geom_point</td>
</tr>
<tr class="even">
<td align="left">stip plots</td>
<td align="left">stripchart</td>
<td align="left">stripplot</td>
<td align="left">goem_point</td>
</tr>
<tr class="odd">
<td align="left">dendrogramms</td>
<td align="left">plot(hclust())</td>
<td align="left">latticeExtra package</td>
<td align="left">ggdendro package</td>
</tr>
<tr class="even">
<td align="left">heatmaps</td>
<td align="left">image, heatmap</td>
<td align="left">levelplot</td>
<td align="left">geom_tile</td>
</tr>
</tbody>
</table>
<p>Below, we are going to use a data from the <em><a href="https://bioconductor.org/packages/3.11/pRolocdata">pRolocdata</a></em> to illustrate the plotting functions.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"pRolocdata"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">tan2009r1</span>)</pre></body></html></div>
<div id="scatter-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#scatter-plots" class="anchor"></a>Scatter plots</h2>
<p>See the MA and volcano plot examples.</p>
<p>The default plot <code>type</code> is <code>p</code>, for points. Other important types are <code>l</code> for lines and <code>h</code> for <em>histogram</em> (see below).</p>
</div>
<div id="historams-and-density-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#historams-and-density-plots" class="anchor"></a>Historams and density plots</h2>
<p>We extract the (normalised) intensities of the first sample</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/tidyeval.html">exprs</a></span>(<span class="no">tan2009r1</span>)[, <span class="fl">1</span>]</pre></body></html></div>
<p>and plot the distribution with a histogram and a density plot next to each other on the same figure (using the <code>mfrow</code> <code>par</code> plotting paramter)</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">x</span>)
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span>(<span class="no">x</span>))</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/histplot-1.png" width="1344"></p>
</div>
<div id="box-plots-and-violin-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#box-plots-and-violin-plots" class="anchor"></a>Box plots and violin plots</h2>
<p>we first extract the 888 proteins by <code>r ncol(tan2009r1)</code> samples data matrix and plot the sample distributions next to each other using <code>boxplot</code> and <code>beanplot</code> (from the <em><a href="https://CRAN.R-project.org/package=beanplot">beanplot</a></em> package).</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"beanplot"</span>)
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/tidyeval.html">exprs</a></span>(<span class="no">tan2009r1</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="no">x</span>)
<span class="fu"><a href="https://rdrr.io/pkg/beanplot/man/beanplot.html">beanplot</a></span>(<span class="no">x</span>[, <span class="fl">1</span>], <span class="no">x</span>[, <span class="fl">2</span>], <span class="no">x</span>[, <span class="fl">3</span>], <span class="no">x</span>[, <span class="fl">4</span>], <span class="kw">log</span> <span class="kw">=</span> <span class="st">""</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/bxplot-1.png" width="672"></p>
</div>
<div id="line-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#line-plots" class="anchor"></a>Line plots</h2>
<p>below, we produce line plots that describe the protein quantitative profiles for two sets of proteins, namely er and mitochondrial proteins using <code>matplot</code>.</p>
<p>we need to transpose the matrix (with <code>t</code>) and set the type to both (<code>b</code>), to display points and lines, the colours to red and steel blue, the point characters to 1 (an empty point) and the line type to 1 (a solid line).</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">er</span> <span class="kw">&lt;-</span> <span class="fu">fData</span>(<span class="no">tan2009r1</span>)$<span class="no">markers</span> <span class="kw">==</span> <span class="st">"ER"</span>
<span class="no">mt</span> <span class="kw">&lt;-</span> <span class="fu">fData</span>(<span class="no">tan2009r1</span>)$<span class="no">markers</span> <span class="kw">==</span> <span class="st">"mitochondrion"</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">x</span>[<span class="no">er</span>, ]), <span class="kw">type</span> <span class="kw">=</span> <span class="st">"b"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">x</span>[<span class="no">mt</span>, ]), <span class="kw">type</span> <span class="kw">=</span> <span class="st">"b"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"steelblue"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/matplotex-1.png" width="672"></p>
<p>In the last section, about spatial proteomics, we use the specialised <code>plotDist</code> function from the <em><a href="https://bioconductor.org/packages/3.11/pRoloc">pRoloc</a></em> package to generate such figures.</p>
</div>
<div id="bar-and-dot-charts" class="section level2">
<h2 class="hasAnchor">
<a href="#bar-and-dot-charts" class="anchor"></a>Bar and dot charts</h2>
<p>To illustrate bar and dot charts, we cound the number of proteins in the respective class using table.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="fu">fData</span>(<span class="no">tan2009r1</span>)$<span class="no">markers</span>)
<span class="no">x</span></pre></body></html></div>
<pre><code>## 
##  Cytoskeleton            ER         Golgi      Lysosome mitochondrion 
##             7            28            13             8            29 
##       Nucleus    Peroxisome            PM    Proteasome  Ribosome 40S 
##            21             4            34            15            20 
##  Ribosome 60S       unknown 
##            32           677</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span>(<span class="no">x</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/dotchart.html">dotchart</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">x</span>))</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/mrkplot-1.png" width="1152"></p>
<!-- ### Strip plots -->
</div>
<div id="heatmaps" class="section level2">
<h2 class="hasAnchor">
<a href="#heatmaps" class="anchor"></a>Heatmaps</h2>
<p>The easiest to produce a complete heatmap is with the <code>heatmap</code> function:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html">heatmap</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/tidyeval.html">exprs</a></span>(<span class="no">tan2009r1</span>))</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/hmap-1.png" width="700"></p>
<p>To produce the a heatmap without the dendrograms, one can use the image function on a matrix or the specialised version for <code>MSnSet</code> objects from the <em><a href="https://bioconductor.org/packages/3.11/MSnbase">MSnbase</a></em> package.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>))
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">1</span>:<span class="fl">9</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span>(<span class="no">x</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span>(<span class="no">tan2009r1</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/image-1.png" width="1344"></p>
<p>See also <em><a href="https://CRAN.R-project.org/package=gplots">gplots</a></em>'s <code>heatmap.2</code> function and the <em><a href="https://bioconductor.org/packages/3.11/Heatplus">Heatplus</a></em> Bioconductor package for more advanced heatmaps and the <em><a href="https://CRAN.R-project.org/package=corrplot">corrplot</a></em> package for correlation matrices.</p>
</div>
<div id="dendrograms" class="section level2">
<h2 class="hasAnchor">
<a href="#dendrograms" class="anchor"></a>Dendrograms</h2>
<p>The easiest way to produce and plot a dendrogram is:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">d</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/tidyeval.html">exprs</a></span>(<span class="no">tan2009r1</span>))) <span class="co">## distance between samples</span>
<span class="no">hc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="no">d</span>) <span class="co">## hierarchical clustering</span>
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">hc</span>) <span class="co">## visualisation</span></pre></body></html></div>
<p><img src="RProtVis_files/figure-html/dendro-1.png" width="700"></p>
<p>See also <em><a href="https://CRAN.R-project.org/package=dendextend">dendextend</a></em> and this <a href="http://stackoverflow.com/questions/6673162/reproducing-lattice-dendrogram-graph-with-ggplot2">post</a> to illustrate <em><a href="https://CRAN.R-project.org/package=latticeExtra">latticeExtra</a></em> and <em><a href="https://CRAN.R-project.org/package=ggdendro">ggdendro</a></em>.</p>
</div>
<div id="venn-diagrams" class="section level2">
<h2 class="hasAnchor">
<a href="#venn-diagrams" class="anchor"></a>Venn diagrams</h2>
<ul>
<li>The <em><a href="https://bioconductor.org/packages/3.11/limma">limma</a></em> package.</li>
<li>The <em><a href="https://CRAN.R-project.org/package=VennDiagram">VennDiagram</a></em> package.</li>
</ul>
</div>
</div>
<div id="visualising-mass-spectrometry-data" class="section level1">
<h1 class="hasAnchor">
<a href="#visualising-mass-spectrometry-data" class="anchor"></a>Visualising mass spectrometry data</h1>
<div id="direct-access-to-the-raw-data" class="section level2">
<h2 class="hasAnchor">
<a href="#direct-access-to-the-raw-data" class="anchor"></a>Direct access to the raw data</h2>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"mzR"</span>)
<span class="no">mzf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpx/man/PXDataset-class.html">pxget</a></span>(<span class="no">px1</span>,
             <span class="st">"TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01-20141210.mzML"</span>)</pre></body></html></div>
<pre><code>## Downloading 1 file</code></pre>
<pre><code>## /home/lgatto/wrk/RforProteomics/vignettes/TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01-20141210.mzML already present.</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="no">ms</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mzR/man/openMSfile.html">openMSfile</a></span>(<span class="no">mzf</span>)

<span class="no">hd</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/pSet-class.html">header</a></span>(<span class="no">ms</span>)
<span class="no">ms1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">hd</span>$<span class="no">msLevel</span> <span class="kw">==</span> <span class="fl">1</span>)

<span class="no">rtsel</span> <span class="kw">&lt;-</span> <span class="no">hd</span>$<span class="no">retentionTime</span>[<span class="no">ms1</span>] / <span class="fl">60</span> <span class="kw">&gt;</span> <span class="fl">30</span> <span class="kw">&amp;</span> <span class="no">hd</span>$<span class="no">retentionTime</span>[<span class="no">ms1</span>] / <span class="fl">60</span> <span class="kw">&lt;</span> <span class="fl">35</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"MSnbase"</span>)
(<span class="no">M</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/MSmap-class.html">MSmap</a></span>(<span class="no">ms</span>, <span class="no">ms1</span>[<span class="no">rtsel</span>], <span class="fl">521</span>, <span class="fl">523</span>, <span class="fl">.005</span>, <span class="no">hd</span>))</pre></body></html></div>
<pre><code>## Object of class "MSmap"
##  Map [75, 401]
##   [1]  Retention time: 30:1 - 34:58 
##   [2]  M/Z: 521 - 523 (res 0.005)</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"lattice"</span>)
<span class="no">ff</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"yellow"</span>, <span class="st">"steelblue"</span>))
<span class="fu"><a href="https://rdrr.io/pkg/lattice/man/trellis.par.get.html">trellis.par.set</a></span>(<span class="kw">regions</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">col</span><span class="kw">=</span><span class="fu">ff</span>(<span class="fl">100</span>)))
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">M</span>, <span class="kw">aspect</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">allTicks</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/mapsheat-1.png" width="700"></p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">M</span>@<span class="kw">map</span>[<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/MSmap-class.html">msMap</a></span>(<span class="no">M</span>) <span class="kw">==</span> <span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/MSmap-class.html">plot3D</a></span>(<span class="no">M</span>, <span class="kw">rgl</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/maps3D-1.png" width="700"></p>
<p>To produce a version that can be reoriented interactively on the screen discplay, use the <em><a href="https://CRAN.R-project.org/package=rgl">rgl</a></em></p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"rgl"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/MSmap-class.html">plot3D</a></span>(<span class="no">M</span>, <span class="kw">rgl</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<div class="sourceCode"><html><body><pre class="r"><span class="no">lout</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">NA</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">10</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">8</span>)
<span class="no">lout</span>[<span class="fl">1</span>:<span class="fl">2</span>, ] <span class="kw">&lt;-</span> <span class="fl">1</span>
<span class="kw">for</span> (<span class="no">ii</span> <span class="kw">in</span> <span class="fl">3</span>:<span class="fl">4</span>)
    <span class="no">lout</span>[<span class="no">ii</span>, ] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>)
<span class="no">lout</span>[<span class="fl">5</span>, ] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">4</span>:<span class="fl">8</span>, <span class="kw">each</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="no">lout</span>[<span class="fl">6</span>, ] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">4</span>:<span class="fl">8</span>, <span class="kw">each</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="no">lout</span>[<span class="fl">7</span>, ] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">9</span>:<span class="fl">13</span>, <span class="kw">each</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="no">lout</span>[<span class="fl">8</span>, ] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">9</span>:<span class="fl">13</span>, <span class="kw">each</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<div class="sourceCode"><html><body><pre class="r"><span class="no">i</span> <span class="kw">&lt;-</span> <span class="no">ms1</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">rtsel</span>)][<span class="fl">1</span>]
<span class="no">j</span> <span class="kw">&lt;-</span> <span class="no">ms1</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">rtsel</span>)][<span class="fl">2</span>]
<span class="no">ms2</span> <span class="kw">&lt;-</span> (<span class="no">i</span>+<span class="fl">1</span>):(<span class="no">j</span>-<span class="fl">1</span>)</pre></body></html></div>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="no">lout</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/chromatogram-MSnExp-method.html">chromatogram</a></span>(<span class="no">ms</span>)<span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">type</span> <span class="kw">=</span> <span class="st">"l"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">v</span> <span class="kw">=</span> <span class="no">hd</span>[<span class="no">i</span>, <span class="st">"retentionTime"</span>], <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span>))
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/mzR/man/peaks.html">peaks</a></span>(<span class="no">ms</span>, <span class="no">i</span>), <span class="kw">type</span> <span class="kw">=</span> <span class="st">"l"</span>, <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">400</span>, <span class="fl">1000</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>,
       <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(
           <span class="st">"Acquisition "</span>, <span class="no">hd</span>[<span class="no">i</span>, <span class="st">"acquisitionNum"</span>],  <span class="st">"\n"</span>,
           <span class="st">"Retention time "</span>, <span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/formatRt.html">formatRt</a></span>(<span class="no">hd</span>[<span class="no">i</span>, <span class="st">"retentionTime"</span>])))
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">h</span> <span class="kw">=</span> <span class="fl">0</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">v</span> <span class="kw">=</span> <span class="no">hd</span>[<span class="no">ms2</span>, <span class="st">"precursorMZ"</span>],
       <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"#FF000080"</span>,
           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"#12121280"</span>, <span class="fl">9</span>)))</pre></body></html></div>
<pre><code>## Warning in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): semi-
## transparency is not supported on this device: reported only once per page</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/mzR/man/peaks.html">peaks</a></span>(<span class="no">ms</span>, <span class="no">i</span>), <span class="kw">type</span> <span class="kw">=</span> <span class="st">"l"</span>, <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">521</span>, <span class="fl">522.5</span>), <span class="kw">yaxt</span> <span class="kw">=</span> <span class="st">"n"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">h</span> <span class="kw">=</span> <span class="fl">0</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">v</span> <span class="kw">=</span> <span class="no">hd</span>[<span class="no">ms2</span>, <span class="st">"precursorMZ"</span>], <span class="kw">col</span> <span class="kw">=</span> <span class="st">"#FF000080"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span>))
<span class="kw">for</span> (<span class="no">ii</span> <span class="kw">in</span> <span class="no">ms2</span>) {
    <span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mzR/man/peaks.html">peaks</a></span>(<span class="no">ms</span>, <span class="no">ii</span>)
    <span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">p</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">""</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">""</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"h"</span>, <span class="kw">cex.axis</span> <span class="kw">=</span> <span class="fl">.6</span>)
    <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>,
           <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Prec M/Z\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">hd</span>[<span class="no">ii</span>, <span class="st">"precursorMZ"</span>], <span class="fl">2</span>)),
           <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">.8</span>)
}</pre></body></html></div>
<div class="figure">
<img src="RProtVis_files/figure-html/msdetailsplot-1.png" alt="Accesing and plotting MS data." width="700"><p class="caption">
Accesing and plotting MS data.
</p>
</div>
<div class="sourceCode"><html><body><pre class="r"><span class="no">M2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/MSmap-class.html">MSmap</a></span>(<span class="no">ms</span>, <span class="no">i</span>:<span class="no">j</span>, <span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">1</span>, <span class="no">hd</span>)
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/MSmap-class.html">plot3D</a></span>(<span class="no">M2</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/maps3D2-1.png" width="700"></p>
<div id="ms-barcoding" class="section level3">
<h3 class="hasAnchor">
<a href="#ms-barcoding" class="anchor"></a>MS barcoding</h3>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">hd</span>$<span class="no">msLevel</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">hd</span>))),
      <span class="kw">xlab</span><span class="kw">=</span><span class="st">"Retention time"</span>,
      <span class="kw">xaxt</span><span class="kw">=</span><span class="st">"n"</span>, <span class="kw">yaxt</span><span class="kw">=</span><span class="st">"n"</span>, <span class="kw">col</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"black"</span>,<span class="st">"steelblue"</span>))
<span class="no">k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="no">hd</span>$<span class="no">retentionTime</span>) / <span class="fl">60</span>)
<span class="no">nk</span> <span class="kw">&lt;-</span> <span class="fl">5</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="kw">side</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">at</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>/<span class="no">nk</span>), <span class="kw">labels</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">k</span>[<span class="fl">1</span>],<span class="no">k</span>[<span class="fl">2</span>],<span class="no">k</span>[<span class="fl">2</span>]/<span class="no">nk</span>))</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/barcode-1.png" width="1152"></p>
</div>
<div id="animation" class="section level3">
<h3 class="hasAnchor">
<a href="#animation" class="anchor"></a>Animation</h3>
<p>The following animation scrolls over 5 minutes of retention time for a MZ range between 521 and 523.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"animation"</span>)
<span class="no">an1</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
    <span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">0.2</span>)) {
        <span class="no">rtsel</span> <span class="kw">&lt;-</span> <span class="no">hd</span>$<span class="no">retentionTime</span>[<span class="no">ms1</span>] / <span class="fl">60</span> <span class="kw">&gt;</span> (<span class="fl">30</span> + <span class="no">i</span>) <span class="kw">&amp;</span>
            <span class="no">hd</span>$<span class="no">retentionTime</span>[<span class="no">ms1</span>] / <span class="fl">60</span> <span class="kw">&lt;</span> (<span class="fl">35</span> + <span class="no">i</span>)
        <span class="no">M</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/MSmap-class.html">MSmap</a></span>(<span class="no">ms</span>, <span class="no">ms1</span>[<span class="no">rtsel</span>], <span class="fl">521</span>, <span class="fl">523</span>, <span class="fl">.005</span>, <span class="no">hd</span>)
        <span class="no">M</span>@<span class="kw">map</span>[<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/MSmap-class.html">msMap</a></span>(<span class="no">M</span>) <span class="kw">==</span> <span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>
        <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/MSmap-class.html">plot3D</a></span>(<span class="no">M</span>, <span class="kw">rgl</span> <span class="kw">=</span> <span class="fl">FALSE</span>))
    }
}

<span class="fu">saveGIF</span>(<span class="fu">an1</span>(), <span class="kw">movie.name</span> <span class="kw">=</span> <span class="st">"msanim1.gif"</span>)</pre></body></html></div>
<div class="figure">
<img src="figures/msanim1.gif" alt="MS animation 1"><p class="caption">MS animation 1</p>
</div>
<p>The code chunk below scrolls of a slice of retention times while keeping the retention time constant between 30 and 35 minutes.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">an2</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
    <span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">2.5</span>, <span class="fl">0.1</span>)) {
        <span class="no">rtsel</span> <span class="kw">&lt;-</span> <span class="no">hd</span>$<span class="no">retentionTime</span>[<span class="no">ms1</span>] / <span class="fl">60</span> <span class="kw">&gt;</span> <span class="fl">30</span> <span class="kw">&amp;</span> <span class="no">hd</span>$<span class="no">retentionTime</span>[<span class="no">ms1</span>] / <span class="fl">60</span> <span class="kw">&lt;</span> <span class="fl">35</span>
        <span class="no">mz1</span> <span class="kw">&lt;-</span> <span class="fl">520</span> + <span class="no">i</span>
        <span class="no">mz2</span> <span class="kw">&lt;-</span> <span class="fl">522</span> + <span class="no">i</span>
        <span class="no">M</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/MSmap-class.html">MSmap</a></span>(<span class="no">ms</span>, <span class="no">ms1</span>[<span class="no">rtsel</span>], <span class="no">mz1</span>, <span class="no">mz2</span>, <span class="fl">.005</span>, <span class="no">hd</span>)
        <span class="no">M</span>@<span class="kw">map</span>[<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/MSmap-class.html">msMap</a></span>(<span class="no">M</span>) <span class="kw">==</span> <span class="fl">0</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>
        <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/MSmap-class.html">plot3D</a></span>(<span class="no">M</span>, <span class="kw">rgl</span> <span class="kw">=</span> <span class="fl">FALSE</span>))
    }
}

<span class="fu">saveGIF</span>(<span class="fu">an2</span>(), <span class="kw">movie.name</span> <span class="kw">=</span> <span class="st">"msanim2.gif"</span>)</pre></body></html></div>
<div class="figure">
<img src="figures/msanim2.gif" alt="MS animation 2"><p class="caption">MS animation 2</p>
</div>
</div>
</div>
<div id="the-msnbase-infrastructure" class="section level2">
<h2 class="hasAnchor">
<a href="#the-msnbase-infrastructure" class="anchor"></a>The <em><a href="https://bioconductor.org/packages/3.11/MSnbase">MSnbase</a></em> infrastructure</h2>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"MSnbase"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">itraqdata</span>)
<span class="no">itraqdata2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/pickPeaks-method.html">pickPeaks</a></span>(<span class="no">itraqdata</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">itraqdata</span><span class="kw">[[</span><span class="fl">25</span>]], <span class="kw">full</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">reporters</span> <span class="kw">=</span> <span class="no">iTRAQ4</span>)</pre></body></html></div>
<pre><code>## Warning in grid.Call.graphics(C_rect, x$x, x$y, x$width, x$height,
## resolveHJust(x$just, : semi-transparency is not supported on this device:
## reported only once per page</code></pre>
<p><img src="RProtVis_files/figure-html/msnbviz-1.png" width="700"></p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">oma</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">itraqdata2</span><span class="kw">[[</span><span class="fl">25</span>]], <span class="no">itraqdata2</span><span class="kw">[[</span><span class="fl">28</span>]], <span class="kw">sequences</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"IMIDLDGTENK"</span>, <span class="fl">2</span>))</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/msnbviz-2.png" width="700"></p>
</div>
<div id="the-protviz-package" class="section level2">
<h2 class="hasAnchor">
<a href="#the-protviz-package" class="anchor"></a>The <em><a href="https://CRAN.R-project.org/package=protViz">protViz</a></em> package</h2>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"protViz"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">msms</span>)

<span class="no">fi</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/protViz/man/fragmentIons.html">fragmentIon</a></span>(<span class="st">"TAFDEAIAELDTLNEESYK"</span>)
<span class="no">fi.cyz</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">c</span><span class="kw">=</span><span class="no">fi</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">c</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">fi</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">y</span>, <span class="kw">z</span><span class="kw">=</span><span class="no">fi</span><span class="kw">[[</span><span class="fl">1</span>]]$<span class="no">z</span>))

<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/protViz/man/peakplot.html">peakplot</a></span>(<span class="st">"TAFDEAIAELDTLNEESYK"</span>,
              <span class="kw">spec</span> <span class="kw">=</span> <span class="no">msms</span><span class="kw">[[</span><span class="fl">1</span>]],
              <span class="kw">fi</span> <span class="kw">=</span> <span class="no">fi.cyz</span>,
              <span class="kw">itol</span> <span class="kw">=</span> <span class="fl">0.6</span>,
              <span class="kw">ion.axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/protviz-1.png" width="700"></p>
<p>The <code>peakplot</code> function return the annotation of the MSMS spectrum that is plotted:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">p</span>)</pre></body></html></div>
<pre><code>## List of 7
##  $ mZ.Da.error : num [1:57] 215.3 144.27 -2.8 -17.06 2.03 ...
##  $ mZ.ppm.error: num [1:57] 1808046 758830 -8306 -37724 3501 ...
##  $ idx         : int [1:57] 1 1 1 3 16 24 41 52 67 88 ...
##  $ label       : chr [1:57] "c1" "c2" "c3" "c4" ...
##  $ score       : num -1
##  $ sequence    : chr "TAFDEAIAELDTLNEESYK"
##  $ fragmentIon :'data.frame':    19 obs. of  3 variables:
##   ..$ c: num [1:19] 119 190 337 452 581 ...
##   ..$ y: num [1:19] 147 310 397 526 655 ...
##   ..$ z: num [1:19] 130 293 380 509 638 ...</code></pre>
</div>
<div id="preprocessing-of-maldi-ms-spectra" class="section level2">
<h2 class="hasAnchor">
<a href="#preprocessing-of-maldi-ms-spectra" class="anchor"></a>Preprocessing of MALDI-MS spectra</h2>
<p>The following code chunks demonstrate the usage of the mass spectrometry preprocessing and plotting routines in the <code>r CRANpkg("MALDIquant")</code> package. <em><a href="https://CRAN.R-project.org/package=MALDIquant">MALDIquant</a></em> uses the traditional graphics system. Therefore <em><a href="https://CRAN.R-project.org/package=MALDIquant">MALDIquant</a></em> overloads the traditional functions <code>plot</code>, <code>lines</code> and <code>points</code> for its own data types. These data types represents spectrum and peak lists as S4 classes. Please see the <em><a href="https://CRAN.R-project.org/package=MALDIquant">MALDIquant</a></em> <a href="http://cran.r-project.org/web/packages/MALDIquant/vignettes/MALDIquant-intro.pdf">vignette</a> and the corresponding <a href="http://strimmerlab.org/software/maldiquant/">website</a> for more details.</p>
<p>After loading some example data a simple <code>plot</code> draws the raw spectrum.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"MALDIquant"</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"fiedler2009subset"</span>, <span class="kw">package</span><span class="kw">=</span><span class="st">"MALDIquant"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">fiedler2009subset</span><span class="kw">[[</span><span class="fl">14</span>]])</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/mqraw-1.png" width="700"></p>
<p>After some preprocessing, namely variance stabilization and smoothing, we use <code>lines</code> to draw our baseline estimate in our processed spectrum.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">transformedSpectra</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/transformIntensity-methods.html">transformIntensity</a></span>(<span class="no">fiedler2009subset</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"sqrt"</span>)
<span class="no">smoothedSpectra</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/smoothIntensity-methods.html">smoothIntensity</a></span>(<span class="no">transformedSpectra</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"SavitzkyGolay"</span>)

<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">smoothedSpectra</span><span class="kw">[[</span><span class="fl">14</span>]])
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/estimateBaseline-methods.html">estimateBaseline</a></span>(<span class="no">smoothedSpectra</span><span class="kw">[[</span><span class="fl">14</span>]]), <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/mqestimatebaseline-1.png" width="700"></p>
<p>After removing the background removal we could use <code>plot</code> again to draw our baseline corrected spectrum.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">rbSpectra</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/removeBaseline-methods.html">removeBaseline</a></span>(<span class="no">smoothedSpectra</span>)
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">rbSpectra</span><span class="kw">[[</span><span class="fl">14</span>]])</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/mqremovebaseline-1.png" width="700"></p>
<p><code>detectPeaks</code> returns a <code>MassPeaks</code> object that offers the same traditional graphics functions. The next code chunk demonstrates how to mark the detected peaks in a spectrum.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">cbSpectra</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/calibrateIntensity-methods.html">calibrateIntensity</a></span>(<span class="no">rbSpectra</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"TIC"</span>)
<span class="no">peaks</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/detectPeaks-methods.html">detectPeaks</a></span>(<span class="no">cbSpectra</span>, <span class="kw">SNR</span> <span class="kw">=</span> <span class="fl">5</span>)

<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">cbSpectra</span><span class="kw">[[</span><span class="fl">14</span>]])
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">peaks</span><span class="kw">[[</span><span class="fl">14</span>]], <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/mqpeaks-1.png" width="700"></p>
<p>Additional there is a special function <code>labelPeaks</code> that allows to draw the <em>M/Z</em> values above the corresponding peaks. Next we mark the 5 top peaks in the spectrum.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">top5</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/AbstractMassObject-class.html">intensity</a></span>(<span class="no">peaks</span><span class="kw">[[</span><span class="fl">14</span>]]) <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/AbstractMassObject-class.html">intensity</a></span>(<span class="no">peaks</span><span class="kw">[[</span><span class="fl">14</span>]]),
                                         <span class="kw">decreasing</span> <span class="kw">=</span> <span class="fl">TRUE</span>)[<span class="fl">1</span>:<span class="fl">5</span>]
<span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/labelPeaks-methods.html">labelPeaks</a></span>(<span class="no">peaks</span><span class="kw">[[</span><span class="fl">14</span>]], <span class="kw">index</span> <span class="kw">=</span> <span class="no">top5</span>, <span class="kw">avoidOverlap</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/mqlabelpeaks-1.png" width="700"></p>
<p>Often multiple spectra have to be recalibrated to be comparable. Therefore <em><a href="https://CRAN.R-project.org/package=MALDIquant">MALDIquant</a></em> warps the spectra according to so called reference or landmark peaks. For debugging the <code>determineWarpingFunctions</code> function offers some warping plots. Here we show only the last 4 plots:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>))
<span class="no">warpingFunctions</span> <span class="kw">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/determineWarpingFunctions-functions.html">determineWarpingFunctions</a></span>(<span class="no">peaks</span>,
                              <span class="kw">tolerance</span> <span class="kw">=</span> <span class="fl">0.001</span>,
                              <span class="kw">plot</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                              <span class="kw">plotInteractive</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/mqwarp-1.png" width="700"></p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>))
<span class="no">warpedSpectra</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/warp-functions.html">warpMassSpectra</a></span>(<span class="no">cbSpectra</span>, <span class="no">warpingFunctions</span>)
<span class="no">warpedPeaks</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/warp-functions.html">warpMassPeaks</a></span>(<span class="no">peaks</span>, <span class="no">warpingFunctions</span>)</pre></body></html></div>
<p>In the next code chunk we visualise the need and the effect of the recalibration.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">sel</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">10</span>, <span class="fl">14</span>, <span class="fl">16</span>)
<span class="no">xlim</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4180</span>, <span class="fl">4240</span>)
<span class="no">ylim</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1.9e-3</span>)
<span class="no">lty</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">6</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">cbSpectra</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">xlim</span> <span class="kw">=</span> <span class="no">xlim</span>, <span class="kw">ylim</span> <span class="kw">=</span> <span class="no">ylim</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>)

<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">along</span> <span class="kw">=</span> <span class="no">sel</span>)) {
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">peaks</span><span class="kw">[[</span><span class="no">sel</span>[<span class="no">i</span>]]], <span class="kw">lty</span> <span class="kw">=</span> <span class="no">lty</span>[<span class="no">i</span>], <span class="kw">col</span> <span class="kw">=</span> <span class="no">i</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">cbSpectra</span><span class="kw">[[</span><span class="no">sel</span>[<span class="no">i</span>]]], <span class="kw">lty</span> <span class="kw">=</span> <span class="no">lty</span>[<span class="no">i</span>], <span class="kw">col</span> <span class="kw">=</span> <span class="no">i</span>)
}

<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">cbSpectra</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">xlim</span> <span class="kw">=</span> <span class="no">xlim</span>, <span class="kw">ylim</span> <span class="kw">=</span> <span class="no">ylim</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>)

<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">along</span> <span class="kw">=</span> <span class="no">sel</span>)) {
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">warpedPeaks</span><span class="kw">[[</span><span class="no">sel</span>[<span class="no">i</span>]]], <span class="kw">lty</span> <span class="kw">=</span> <span class="no">lty</span>[<span class="no">i</span>], <span class="kw">col</span> <span class="kw">=</span> <span class="no">i</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">warpedSpectra</span><span class="kw">[[</span><span class="no">sel</span>[<span class="no">i</span>]]], <span class="kw">lty</span> <span class="kw">=</span> <span class="no">lty</span>[<span class="no">i</span>], <span class="kw">col</span> <span class="kw">=</span> <span class="no">i</span>)
}</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/mqwarped-1.png" width="700"></p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>))</pre></body></html></div>
<p>The code chunks above generate plots that are very similar to the figure 7 in the corresponding paper <em>"Visualisation of proteomics data using R"</em>. Please find the code to exactly reproduce the figure at: <a href="https://github.com/sgibb/MALDIquantExamples/blob/master/R/createFigure1_color.R" class="uri">https://github.com/sgibb/MALDIquantExamples/blob/master/R/createFigure1_color.R</a></p>
</div>
</div>
<div id="genomic-and-protein-sequences" class="section level1">
<h1 class="hasAnchor">
<a href="#genomic-and-protein-sequences" class="anchor"></a>Genomic and protein sequences</h1>
<p>These visualisations originate from the <code>Pbase</code> <a href="http://bioconductor.org/packages/devel/bioc/vignettes/Pbase/inst/doc/Pbase-data.html"><code>Pbase-data</code></a> and <a href="http://bioconductor.org/packages/devel/bioc/vignettes/Pbase/inst/doc/mapping.html"><code>mapping</code></a> vignettes.</p>
</div>
<div id="mass-spectrometry-imaging" class="section level1">
<h1 class="hasAnchor">
<a href="#mass-spectrometry-imaging" class="anchor"></a>Mass spectrometry imaging</h1>
<p>The following code chunk downloads a MALDI imaging dataset from a mouse kidney shared by <a href="http://figshare.com/articles/MALDI_Imaging_Mass_Spectrometry_of_a_Mouse_Kidney/735961">Adrien Nyakas and Stefan Schurch</a> and generates a plot with the mean spectrum and three slices of interesting <em>M/Z</em> regions.</p>
<!-- Not running this code chunk as the access to the data (75M) -->
<!-- on figshare seems to hang or become very slow at times -->
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"MALDIquant"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"MALDIquantForeign"</span>)

<span class="no">spectra</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquantForeign/man/importBrukerFlex-functions.html">importBrukerFlex</a></span>(<span class="st">"http://files.figshare.com/1106682/MouseKidney_IMS_testdata.zip"</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

<span class="no">spectra</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/smoothIntensity-methods.html">smoothIntensity</a></span>(<span class="no">spectra</span>, <span class="st">"SavitzkyGolay"</span>,  <span class="kw">halfWindowSize</span> <span class="kw">=</span> <span class="fl">8</span>)
<span class="no">spectra</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/removeBaseline-methods.html">removeBaseline</a></span>(<span class="no">spectra</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"TopHat"</span>, <span class="kw">halfWindowSize</span> <span class="kw">=</span> <span class="fl">16</span>)
<span class="no">spectra</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/calibrateIntensity-methods.html">calibrateIntensity</a></span>(<span class="no">spectra</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"TIC"</span>)
<span class="no">avgSpectrum</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/averageMassSpectra-functions.html">averageMassSpectra</a></span>(<span class="no">spectra</span>)
<span class="no">avgPeaks</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/detectPeaks-methods.html">detectPeaks</a></span>(<span class="no">avgSpectrum</span>, <span class="kw">SNR</span> <span class="kw">=</span> <span class="fl">5</span>)

<span class="no">avgPeaks</span> <span class="kw">&lt;-</span> <span class="no">avgPeaks</span>[<span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/AbstractMassObject-class.html">intensity</a></span>(<span class="no">avgPeaks</span>) <span class="kw">&gt;</span> <span class="fl">0.0015</span>]

<span class="no">oldPar</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">no.readonly</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>), <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>))
<span class="fu"><a href="https://rdrr.io/pkg/MSnbase/man/plot-methods.html">plot</a></span>(<span class="no">avgSpectrum</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"mean spectrum"</span>,
     <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3000</span>, <span class="fl">6000</span>), <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.007</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">avgPeaks</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/labelPeaks-methods.html">labelPeaks</a></span>(<span class="no">avgPeaks</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>))
<span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/plotMsiSlice-methods.html">plotMsiSlice</a></span>(<span class="no">spectra</span>,
             <span class="kw">center</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/MALDIquant/man/AbstractMassObject-class.html">mass</a></span>(<span class="no">avgPeaks</span>),
             <span class="kw">tolerance</span> <span class="kw">=</span> <span class="fl">1</span>,
             <span class="kw">plotInteractive</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="no">oldPar</span>)</pre></body></html></div>
<p><img src="figures/mqmsi-1.png" alt="mqmsi">)]</p>
<div id="an-interactive-shiny-app-for-imaging-mass-spectrometry" class="section level2">
<h2 class="hasAnchor">
<a href="#an-interactive-shiny-app-for-imaging-mass-spectrometry" class="anchor"></a>An interactive <em><a href="https://CRAN.R-project.org/package=shiny">shiny</a></em> app for Imaging mass spectrometry</h2>
<p>There is also an interactive <a href="https://github.com/sgibb/ims-shiny">MALDIquant IMS shiny app</a> for demonstration purposes. A screen shot is displayed below. To start the application:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"shiny"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runUrl.html">runGitHub</a></span>(<span class="st">"sgibb/ims-shiny"</span>)</pre></body></html></div>
<div class="figure">
<img src="figures/ims-shiny.png" alt="ims-shiny screeshot"><p class="caption">ims-shiny screeshot</p>
</div>
</div>
</div>
<div id="spatial-proteomics" class="section level1">
<h1 class="hasAnchor">
<a href="#spatial-proteomics" class="anchor"></a>Spatial proteomics</h1>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"pRoloc"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"pRolocdata"</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">tan2009r1</span>)

<span class="co">## these params use class weights</span>
<span class="no">fn</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"pRoloc"</span>),
          <span class="kw">full.names</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"params2.rda"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="no">fn</span>)

<span class="fu"><a href="https://rdrr.io/pkg/pRoloc/man/getStockcol.html">setStockcol</a></span>(<span class="kw">NULL</span>)
<span class="fu"><a href="https://rdrr.io/pkg/pRoloc/man/getStockcol.html">setStockcol</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/pRoloc/man/getStockcol.html">getStockcol</a></span>(), <span class="fl">90</span>))

<span class="no">w</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="fu">fData</span>(<span class="no">tan2009r1</span>)[, <span class="st">"pd.markers"</span>])
(<span class="no">w</span> <span class="kw">&lt;-</span> <span class="fl">1</span>/<span class="no">w</span>[<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">w</span>) <span class="kw">!=</span> <span class="st">"unknown"</span>])</pre></body></html></div>
<pre><code>## 
##  Cytoskeleton            ER         Golgi      Lysosome mitochondrion 
##    0.14285714    0.05000000    0.16666667    0.12500000    0.07142857 
##       Nucleus    Peroxisome            PM    Proteasome  Ribosome 40S 
##    0.05000000    0.25000000    0.06666667    0.09090909    0.07142857 
##  Ribosome 60S 
##    0.04000000</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="no">tan2009r1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pRoloc/man/svmClassification.html">svmClassification</a></span>(<span class="no">tan2009r1</span>, <span class="no">params2</span>,
                               <span class="kw">class.weights</span> <span class="kw">=</span> <span class="no">w</span>,
                               <span class="kw">fcol</span> <span class="kw">=</span> <span class="st">"pd.markers"</span>)
<span class="no">ptsze</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="fu">fData</span>(<span class="no">tan2009r1</span>)$<span class="no">svm.scores</span>) - <span class="fl">1</span></pre></body></html></div>
<div class="sourceCode"><html><body><pre class="r"><span class="no">lout</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">5</span>, <span class="fl">4</span>)), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="no">lout</span>)
<span class="no">cls</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pRoloc/man/getStockcol.html">getStockcol</a></span>()
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/pkg/pRoloc/man/plotDist.html">plotDist</a></span>(<span class="no">tan2009r1</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu">fData</span>(<span class="no">tan2009r1</span>)$<span class="no">PLSDA</span> <span class="kw">==</span> <span class="st">"mitochondrion"</span>), ],
         <span class="kw">markers</span> <span class="kw">=</span> <span class="fu">featureNames</span>(<span class="no">tan2009r1</span>)[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu">fData</span>(<span class="no">tan2009r1</span>)$<span class="no">markers.orig</span> <span class="kw">==</span> <span class="st">"mitochondrion"</span>)],
         <span class="kw">mcol</span> <span class="kw">=</span> <span class="no">cls</span>[<span class="fl">5</span>])</pre></body></html></div>
<pre><code>## Warning in plot.xy(xy.coords(x, y), type = type, ...): semi-transparency is not
## supported on this device: reported only once per page</code></pre>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="kw">legend</span> <span class="kw">=</span> <span class="st">"mitochondrion"</span>, <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/pRoloc/man/plotDist.html">plotDist</a></span>(<span class="no">tan2009r1</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu">fData</span>(<span class="no">tan2009r1</span>)$<span class="no">PLSDA</span> <span class="kw">==</span> <span class="st">"ER/Golgi"</span>), ],
         <span class="kw">markers</span> <span class="kw">=</span> <span class="fu">featureNames</span>(<span class="no">tan2009r1</span>)[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu">fData</span>(<span class="no">tan2009r1</span>)$<span class="no">markers.orig</span> <span class="kw">==</span> <span class="st">"ER"</span>)],
         <span class="kw">mcol</span> <span class="kw">=</span> <span class="no">cls</span>[<span class="fl">2</span>])
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="kw">legend</span> <span class="kw">=</span> <span class="st">"ER"</span>, <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/pRoloc/man/plotDist.html">plotDist</a></span>(<span class="no">tan2009r1</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu">fData</span>(<span class="no">tan2009r1</span>)$<span class="no">PLSDA</span> <span class="kw">==</span> <span class="st">"ER/Golgi"</span>), ],
         <span class="kw">markers</span> <span class="kw">=</span> <span class="fu">featureNames</span>(<span class="no">tan2009r1</span>)[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu">fData</span>(<span class="no">tan2009r1</span>)$<span class="no">markers.orig</span> <span class="kw">==</span> <span class="st">"Golgi"</span>)],
         <span class="kw">mcol</span> <span class="kw">=</span> <span class="no">cls</span>[<span class="fl">3</span>])
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="kw">legend</span> <span class="kw">=</span> <span class="st">"Golgi"</span>, <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/pRoloc/man/plotDist.html">plotDist</a></span>(<span class="no">tan2009r1</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu">fData</span>(<span class="no">tan2009r1</span>)$<span class="no">PLSDA</span> <span class="kw">==</span> <span class="st">"PM"</span>), ],
         <span class="kw">markers</span> <span class="kw">=</span> <span class="fu">featureNames</span>(<span class="no">tan2009r1</span>)[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="fu">fData</span>(<span class="no">tan2009r1</span>)$<span class="no">markers.orig</span> <span class="kw">==</span> <span class="st">"PM"</span>)],
         <span class="kw">mcol</span> <span class="kw">=</span> <span class="no">cls</span>[<span class="fl">8</span>])
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="kw">legend</span> <span class="kw">=</span> <span class="st">"PM"</span>, <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/pRoloc/man/plot2D.html">plot2D</a></span>(<span class="no">tan2009r1</span>, <span class="kw">fcol</span> <span class="kw">=</span> <span class="st">"svm"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="no">ptsze</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"kpca"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/pRoloc/man/addLegend.html">addLegend</a></span>(<span class="no">tan2009r1</span>, <span class="kw">where</span> <span class="kw">=</span> <span class="st">"bottomleft"</span>, <span class="kw">fcol</span> <span class="kw">=</span> <span class="st">"svm"</span>, <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>)</pre></body></html></div>
<p><img src="RProtVis_files/figure-html/spatplot-1.png" width="1152"></p>
<p>See the <a href="http://bioconductor.org/packages/release/bioc/vignettes/pRoloc/inst/doc/pRoloc-tutorial.pdf"><code>pRoloc-tutorial</code></a> vignette (pdf) from the <em><a href="https://bioconductor.org/packages/3.11/pRoloc">pRoloc</a></em> package for details about spatial proteomics data analysis and visualisation.</p>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h1>
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>(), <span class="kw">locale</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<pre><code>## R version 4.0.0 (2020-04-24)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 18.04.4 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/libf77blas.so.3.10.3
## LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3
## 
## attached base packages:
## [1] stats4    parallel  stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] beanplot_1.2           ggplot2_3.3.1          lattice_0.20-41       
##  [4] e1071_1.7-3            msmsTests_1.26.0       msmsEDA_1.26.0        
##  [7] pRolocdata_1.26.0      pRoloc_1.28.0          BiocParallel_1.22.0   
## [10] MLInterfaces_1.68.0    cluster_2.1.0          annotate_1.66.0       
## [13] XML_3.99-0.3           AnnotationDbi_1.50.0   IRanges_2.22.2        
## [16] MALDIquantForeign_0.12 MALDIquant_1.19.5      RColorBrewer_1.1-2    
## [19] xtable_1.8-4           rpx_1.24.0             knitr_1.28            
## [22] DT_0.13                protViz_0.6.8          BiocManager_1.30.10   
## [25] RforProteomics_1.27.1  MSnbase_2.14.2         ProtGenerics_1.20.0   
## [28] S4Vectors_0.26.1       mzR_2.22.0             Rcpp_1.0.4.6          
## [31] Biobase_2.48.0         BiocGenerics_0.34.0    BiocStyle_2.16.0      
## 
## loaded via a namespace (and not attached):
##   [1] R.utils_2.9.2            RUnit_0.4.32             tidyselect_1.1.0        
##   [4] RSQLite_2.2.0            htmlwidgets_1.5.1        grid_4.0.0              
##   [7] lpSolve_5.6.15           pROC_1.16.2              munsell_0.5.0           
##  [10] codetools_0.2-16         preprocessCore_1.50.0    withr_2.2.0             
##  [13] colorspace_1.4-1         highr_0.8                mzID_1.26.0             
##  [16] labeling_0.3             farver_2.0.3             bit64_0.9-7             
##  [19] rprojroot_1.3-2          coda_0.19-3              vctrs_0.3.1             
##  [22] generics_0.0.2           ipred_0.9-9              xfun_0.14               
##  [25] BiocFileCache_1.12.0     randomForest_4.6-14      R6_2.4.1                
##  [28] doParallel_1.0.15        locfit_1.5-9.4           bitops_1.0-6            
##  [31] assertthat_0.2.1         promises_1.1.0           scales_1.1.1            
##  [34] nnet_7.3-14              gtable_0.3.0             affy_1.66.0             
##  [37] biocViews_1.56.0         timeDate_3043.102        rlang_0.4.6             
##  [40] splines_4.0.0            ModelMetrics_1.2.2.2     impute_1.62.0           
##  [43] hexbin_1.28.1            yaml_2.2.1               reshape2_1.4.4          
##  [46] crosstalk_1.1.0.1        backports_1.1.7          httpuv_1.5.4            
##  [49] qvalue_2.20.0            RBGL_1.64.0              caret_6.0-86            
##  [52] tools_4.0.0              lava_1.6.7               bookdown_0.19           
##  [55] affyio_1.58.0            ellipsis_0.3.1           gplots_3.0.3            
##  [58] readBrukerFlexData_1.8.5 proxy_0.4-24             plyr_1.8.6              
##  [61] base64enc_0.1-3          progress_1.2.2           zlibbioc_1.34.0         
##  [64] purrr_0.3.4              RCurl_1.98-1.2           prettyunits_1.1.1       
##  [67] rpart_4.1-15             openssl_1.4.1            viridis_0.5.1           
##  [70] sampling_2.8             LaplacesDemon_16.1.4     fs_1.4.1                
##  [73] magrittr_1.5             data.table_1.12.8        pcaMethods_1.80.0       
##  [76] mvtnorm_1.1-0            hms_0.5.3                mime_0.9                
##  [79] evaluate_0.14            mclust_5.4.6             gridExtra_2.3           
##  [82] compiler_4.0.0           biomaRt_2.44.0           tibble_3.0.1            
##  [85] KernSmooth_2.23-17       ncdf4_1.17               crayon_1.3.4            
##  [88] R.oo_1.23.0              htmltools_0.4.0          segmented_1.1-0         
##  [91] later_1.1.0.1            lubridate_1.7.8          DBI_1.1.0               
##  [94] dbplyr_1.4.4             MASS_7.3-51.6            rappdirs_0.3.1          
##  [97] Matrix_1.2-18            vsn_3.56.0               R.methodsS3_1.8.0       
## [100] gdata_2.18.0             gower_0.2.1              pkgconfig_2.0.3         
## [103] pkgdown_1.5.1            readMzXmlData_2.8.1      recipes_0.1.12          
## [106] xml2_1.3.2               foreach_1.5.0            prodlim_2019.11.13      
## [109] stringr_1.4.0            digest_0.6.25            graph_1.66.0            
## [112] rmarkdown_2.2            edgeR_3.30.3             dendextend_1.13.4       
## [115] curl_4.3                 kernlab_0.9-29           shiny_1.4.0.2           
## [118] gtools_3.8.2             jsonlite_1.6.1           lifecycle_0.2.0         
## [121] nlme_3.1-147             desc_1.2.0               viridisLite_0.3.0       
## [124] askpass_1.1              limma_3.44.1             pillar_1.4.4            
## [127] fastmap_1.0.1            httr_1.4.1               survival_3.1-12         
## [130] glue_1.4.1               FNN_1.1.3                iterators_1.0.12        
## [133] bit_1.1-15.2             class_7.3-17             stringi_1.4.6           
## [136] mixtools_1.2.0           blob_1.2.1               caTools_1.18.0          
## [139] memoise_1.1.0            dplyr_1.0.0</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Laurent Gatto.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
